# 项目结构
- 项目代码：[https://github.com/KkQ36/dynamic-thread-pool](https://github.com/KkQ36/dynamic-thread-pool)
- 分支：main
这个模块是作为类似 xxl-job 的管理端来使用的，提供给外部接口来访问。
```
├── dynamic-thread-pool-admin
│   ├── pom.xml
│   └── src
│       ├── main
│       │   ├── java
│       │   │   └── com
│       │   │       └── ryan
│       │   │           └── sdk
│       │   │               ├── Application.java
│       │   │               ├── controller
│       │   │               │   └── DynamicThreadPoolController.java
│       │   │               ├── domain
│       │   │               │   └── pool
│       │   │               │       ├── commons
│       │   │               │       │   └── RegistryEnums.java
│       │   │               │       └── model
│       │   │               │           └── entity
│       │   │               │               └── ThreadPoolConfigEntity.java
│       │   │               └── types
│       │   │                   └── Response.java
│       │   └── resources
│       │       ├── application-dev.yml
│       │       └── application.yml
│       └── test
│           └── java
```
# 核心代码
>[!note] com.ryan.sdk.controller.DynamicThreadPoolController
```java

@Slf4j  
@RestController  
@RequestMapping("/dynamic")  
public class DynamicThreadPoolController {  
  
    @Resource  
    RedissonClient redissonClient;  
  
    @RequestMapping("/thread/pool/config/list")  
    public Object queryThreadPoolConfigList() {  
        try {  
            RList<ThreadPoolConfigEntity> list = redissonClient.getList(RegistryEnums.THREAD_POOL_CONFIG_LIST_KEY.getKey());  
            return Response.<List<ThreadPoolConfigEntity>>builder()  
                    .code(Response.Code.SUCCESS.getCode())  
                    .info(Response.Code.SUCCESS.getInfo())  
                    .data(list.readAll())  
                    .build();  
        } catch (Exception e) {  
            return Response.<List<ThreadPoolConfigEntity>>builder()  
                    .code(Response.Code.UN_ERROR.getCode())  
                    .info(Response.Code.UN_ERROR.getInfo())  
                    .build();  
        }  
    }  
  
    @GetMapping("/thread/pool/config/query")  
    public Object queryThreadPoolConfig(@RequestParam String appName, @RequestParam String threadPoolName) {  
        try {  
            String cacheKey = RegistryEnums.THREAD_POOL_CONFIG_PARAMETER_LIST_KEY.getKey() + "_" + threadPoolName + "_" + appName;  
            RBucket<ThreadPoolConfigEntity> entityRBucket = redissonClient.getBucket(cacheKey);  
            return Response.<ThreadPoolConfigEntity>builder()  
                    .code(Response.Code.SUCCESS.getCode())  
                    .info(Response.Code.SUCCESS.getInfo())  
                    .data(entityRBucket.get())  
                    .build();  
        } catch (Exception e) {  
            return Response.<String>builder()  
                    .code(Response.Code.UN_ERROR.getCode())  
                    .info(Response.Code.UN_ERROR.getInfo())  
                    .data(e.getMessage())  
                    .build();  
        }  
    }  
  
    @PostMapping("/thread/pool/config/update")  
    public Object updateThreadPoolConfig(@RequestBody ThreadPoolConfigEntity threadPoolConfigEntity) {  
        try {  
            String topicName = RegistryEnums.DYNAMIC_THREAD_POOL_REDIS_TOPIC.getKey() + "_" + threadPoolConfigEntity.getAppName();  
            RTopic topic = redissonClient.getTopic(topicName);  
            topic.publish(threadPoolConfigEntity);  
            log.info("发布事件,topic 为 {}", topicName);  
            log.info("编码器{}", redissonClient.getConfig().getCodec());  
            return Response.<List<ThreadPoolConfigEntity>>builder()  
                    .code(Response.Code.SUCCESS.getCode())  
                    .info(Response.Code.SUCCESS.getInfo())  
                    .data(null)  
                    .build();  
        } catch (Exception e) {  
            return Response.<List<ThreadPoolConfigEntity>>builder()  
                    .code(Response.Code.UN_ERROR.getCode())  
                    .info(Response.Code.UN_ERROR.getInfo())  
                    .build();  
        }  
    }  
  
}
```